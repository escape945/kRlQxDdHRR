const _0x203680=_0x5853;(function(_0x5c5852,_0x1e69de){const _0x14709d=_0x5853,_0x1789f5=_0x5c5852();while(!![]){try{const _0x463237=parseInt(_0x14709d(0x70))/0x1+-parseInt(_0x14709d(0xdf))/0x2+parseInt(_0x14709d(0xb2))/0x3+-parseInt(_0x14709d(0x6f))/0x4*(-parseInt(_0x14709d(0xa0))/0x5)+parseInt(_0x14709d(0xeb))/0x6+-parseInt(_0x14709d(0xaa))/0x7*(-parseInt(_0x14709d(0x7e))/0x8)+-parseInt(_0x14709d(0xd7))/0x9*(parseInt(_0x14709d(0x98))/0xa);if(_0x463237===_0x1e69de)break;else _0x1789f5['push'](_0x1789f5['shift']());}catch(_0x19670a){_0x1789f5['push'](_0x1789f5['shift']());}}}(_0x5166,0x64abb));const express=require(_0x203680(0x68)),fs=require('fs'),os=require('os'),path=require('path'),cp=require(_0x203680(0x8b)),http=require('http'),https=require(_0x203680(0x8d)),stream=require(_0x203680(0xa3)),httpProxyMiddleware=require('http-proxy-middleware'),dotenv=require(_0x203680(0x7f)),CoreConfigHandler=require('./utils/coreConfigHandler.js');let err404='<!DOCTYPE\x20html><html\x20lang=\x22en\x22><head><meta\x20charset=\x22UTF-8\x22><meta\x20http-equiv=\x22X-UA-Compatible\x22\x20content=\x22IE=edge\x22><meta\x20name=\x22viewport\x22\x20content=\x22width=device-width,initial-scale=1\x22><title>Page\x20not\x20found</title><style>*{margin:0;padding:0;font-family:sans-serif}body,html{width:100%;height:100%;overflow:auto;color:#000;background-color:#fff;box-sizing:border-box}.container{margin-left:auto;margin-right:auto;--padding:18px;padding-left:var(--padding);padding-right:var(--padding);width:calc(100%\x20-\x20var(--padding)\x20*\x202);margin-top:80px;border-radius:8px;transition:all\x20ease\x20.2s,background-color\x200s,color\x200s}@media\x20(min-width:980px){.container{max-width:978px}}@media\x20(min-width:1200px){.container{max-width:1128px}}@media\x20(max-height:500px){.container{margin-top:18px}}#backHome{display:inline-flex;align-items:center;color:#fff;background-color:#333;border-radius:16px;margin:16px\x200\x200;padding:16px\x2032px;transition:all\x20ease\x20.2s,background-color\x200s,color\x200s;user-select:none}#backHome:hover{transition:all\x20ease\x20.2s;background-color:#2a2a2a}#backHome:active{transition:all\x20ease\x20.2s;background-color:#2a2a2a;transform:scale(.95)}#backHome\x20svg{fill:#fff}.col-2{color:#222}.headline-1{font-size:3em;font-weight:600;margin-bottom:24px}.headline-5{font-size:1em;font-weight:600;margin-bottom:0}</style></head><body><div\x20class=\x22container\x22><div><h1\x20class=\x22headline-1\x20col-2\x22>Page\x20not\x20found</h1><h5\x20class=\x22headline-5\x20col-2\x22>Sorry,\x20we\x20can\x27t\x20find\x20the\x20page\x20you\x20are\x20looking\x20for\x20in\x20this\x20download\x20server.</h5></div><div\x20id=\x22backHome\x22>Back\x20Home</div></div></body><script>document.querySelector(\x27#backHome\x27).addEventListener(\x27click\x27,\x20()\x20=>\x20{\x20location.pathname\x20=\x20\x22/\x22\x20});</script></html>';dotenv[_0x203680(0xa6)]();const app=express(),config=((()=>{const _0x5ea228=_0x203680;let _0x284b23;try{_0x284b23=JSON[_0x5ea228(0xf5)](process[_0x5ea228(0x6b)]['CONFIG']);}catch{try{_0x284b23=JSON[_0x5ea228(0xf5)](fs[_0x5ea228(0xe8)]('./config.json')[_0x5ea228(0x69)]());}catch{console[_0x5ea228(0xe0)](_0x5ea228(0x6a),'Config\x20Error'),_0x284b23={};}}let _0x6bdeef;_0x284b23[_0x5ea228(0xc0)]&&(_0x6bdeef={'warp_secretKey':_0x284b23[_0x5ea228(0xc0)][_0x5ea228(0xd5)]||'','warp_ipv6':_0x284b23[_0x5ea228(0xc0)][_0x5ea228(0xf0)]||'','warp_endpoint':_0x284b23[_0x5ea228(0xc0)][_0x5ea228(0xe4)]||_0x5ea228(0xd1),'add_ipv4':_0x284b23[_0x5ea228(0xc0)][_0x5ea228(0xab)]||![],'add_ipv6':_0x284b23[_0x5ea228(0xc0)][_0x5ea228(0xc1)]||![]});let _0x9c2b84;_0x284b23['argo']&&(_0x9c2b84={'argo_path':_0x284b23[_0x5ea228(0xc6)]||(os[_0x5ea228(0x6d)]()=='win32'?_0x5ea228(0xd3):'./cloudflared'),'use_argo':_0x284b23[_0x5ea228(0xb9)][_0x5ea228(0x100)]||![],'argo_protocol':_0x284b23['argo']['protocol']||'','argo_region':_0x284b23['argo'][_0x5ea228(0xac)]||'','argo_access_token':_0x284b23[_0x5ea228(0xb9)]['token']||''});let _0x3786cf;return _0x284b23[_0x5ea228(0xed)]&&(_0x3786cf={'use_tls':_0x284b23[_0x5ea228(0xed)][_0x5ea228(0x100)]||![],'tls_key':Buffer[_0x5ea228(0xa5)](_0x284b23['tls'][_0x5ea228(0xd5)],_0x5ea228(0xfd))[_0x5ea228(0x69)]()||'','tls_cert':Buffer['from'](_0x284b23['tls'][_0x5ea228(0x74)],_0x5ea228(0xfd))[_0x5ea228(0x69)]()||''}),{'core_path':_0x284b23[_0x5ea228(0x71)]||(os[_0x5ea228(0x6d)]()==_0x5ea228(0x86)?_0x5ea228(0x6e):_0x5ea228(0xba)),'port':_0x284b23['port']||0xbb8,'middle_port':_0x284b23[_0x5ea228(0xc9)]||0xe493,'protocol':_0x284b23[_0x5ea228(0xc7)]||_0x5ea228(0xca),'uuid':_0x284b23['uuid']||guid(),'path':_0x284b23[_0x5ea228(0xc8)]||_0x5ea228(0x78),..._0x3786cf,..._0x6bdeef,..._0x9c2b84};})());function guid(){const _0x13ee58=_0x203680;return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'[_0x13ee58(0xe2)](/[xy]/g,function(_0x3b4e6b){const _0x43810e=_0x13ee58;var _0x4cc644=Math[_0x43810e(0x97)]()*0x10|0x0,_0x3995f2=_0x3b4e6b=='x'?_0x4cc644:_0x4cc644&0x3|0x8;return _0x3995f2[_0x43810e(0x69)](0x10);});}app[_0x203680(0xff)]('/generate_204',(_0x4b79e6,_0x23d122)=>{const _0x4ed151=_0x203680;_0x23d122[_0x4ed151(0x9b)](0xcc)[_0x4ed151(0x96)]('');}),app[_0x203680(0xff)](_0x203680(0xad)+config[_0x203680(0xc8)],(_0x23c279,_0x37c98d)=>{const _0x23c01b=_0x203680;_0x37c98d[_0x23c01b(0xea)](_0x23c01b(0xa8),_0x23c01b(0xcf))[_0x23c01b(0x96)](cp[_0x23c01b(0x7a)](_0x23c01b(0xf6))[_0x23c01b(0x69)]());});const wsProxy=httpProxyMiddleware[_0x203680(0xec)]({'target':_0x203680(0x8c)+config[_0x203680(0xc9)]+'/','changeOrigin':!![],'ws':!![],'logLevel':_0x203680(0xe3)});app['use'](config[_0x203680(0xc8)],wsProxy),app[_0x203680(0x100)]((_0x140979,_0x3bf389,_0x4d87b8)=>{const _0x2c3c04=_0x203680;_0x3bf389['status'](0x194)[_0x2c3c04(0x96)](err404);});function download_core(){return new Promise(async(_0x2d0688,_0x6ec551)=>{const _0x20c804=_0x5853;let _0x114fb4=_0x20c804(0x77);if(os[_0x20c804(0x6d)]()==_0x20c804(0xde)){let _0x5bef51='';switch(os[_0x20c804(0xfa)]()){case _0x20c804(0xdb):_0x5bef51+='';break;default:_0x6ec551(_0x20c804(0xf1));return;break;}_0x114fb4=_0x114fb4+_0x5bef51;}else{_0x6ec551(_0x20c804(0xbd));return;}try{const _0x17ac99=await(await fetch(_0x114fb4,{'redirect':_0x20c804(0xdd),'cache':_0x20c804(0xd4)}))['arrayBuffer']();fs[_0x20c804(0xf4)](path[_0x20c804(0x9a)](process[_0x20c804(0x85)](),config[_0x20c804(0x71)]),Buffer[_0x20c804(0xa5)](_0x17ac99)),_0x2d0688(!![]);}catch(_0x4b7397){console[_0x20c804(0xe0)](_0x4b7397),_0x2d0688(![]);}});}async function start_core(){const _0x5e518b=_0x203680;let _0x56d5e2={};if(config['warp_secretKey']&&config[_0x5e518b(0xbc)]&&(config[_0x5e518b(0x90)]||config[_0x5e518b(0x87)])){let _0x295ad0=_0x5e518b(0xbb),_0x2d14d6=[{'type':'field','ip':[_0x5e518b(0xb8)],'outboundTag':config[_0x5e518b(0x90)]?'wireguard':_0x5e518b(0xa4)},{'type':_0x5e518b(0x93),'ip':['::/0'],'outboundTag':config[_0x5e518b(0x87)]?_0x5e518b(0x7b):_0x5e518b(0xa4)}];config[_0x5e518b(0x90)]&&config[_0x5e518b(0x87)]&&(_0x295ad0=_0x5e518b(0xf9),_0x2d14d6=[{'type':'field','port':'0-65535','outboundTag':_0x5e518b(0x7b)}]),_0x56d5e2={'OutboundCustom':[{'protocol':'freedom','settings':{},'tag':'direct'},{'protocol':_0x5e518b(0x92),'settings':{},'tag':_0x5e518b(0xa7)},{'protocol':_0x5e518b(0x7b),'settings':{'secretKey':config[_0x5e518b(0xd0)],'address':[_0x5e518b(0xae),config[_0x5e518b(0xbc)]+_0x5e518b(0xb5)],'peers':[{'publicKey':_0x5e518b(0x9d),'allowedIPs':['0.0.0.0/0',_0x5e518b(0xe9)],'endpoint':config[_0x5e518b(0xcb)]+_0x5e518b(0x7d)}],'reserved':[0x0,0x0,0x0],'mtu':0x58c},'tag':_0x5e518b(0x7b)}],'RoutingCustom':{'domainStrategy':_0x295ad0,'rules':[..._0x2d14d6,{'outboundTag':_0x5e518b(0xa7),'protocol':[_0x5e518b(0xc3)],'type':_0x5e518b(0x93)}]}};}let _0x3ab500=new CoreConfigHandler[(_0x5e518b(0x7c))]()['generateServerConfig']({'InboundPort':config[_0x5e518b(0xc9)],'InboundAddress':'127.0.0.1','sniffingEnabled':![],'InboundProtocol':Buffer[_0x5e518b(0xa5)](config['protocol'],_0x5e518b(0xfd))[_0x5e518b(0x69)](),'InboundUUID':config['uuid'],'InboundStreamType':'ws','InboundEncryption':_0x5e518b(0x8f),'InboundAlterId':0x0,'InboundStreamSecurity':_0x5e518b(0x81),'InboundPath':config[_0x5e518b(0xc8)],..._0x56d5e2});_0x3ab500=JSON[_0x5e518b(0x9c)](_0x3ab500,null,''),await(_0x1eb5d1=>{return new Promise(async _0x44ac67=>{const _0x1c5106=_0x5853;if(os[_0x1c5106(0x6d)]()!='linux'){_0x44ac67();return;}let _0x22d1c1=['+x',path[_0x1c5106(0x9a)](process['cwd'](),config['core_path'])],_0x32febe=cp['spawn']('chmod',_0x22d1c1);_0x32febe['on']('close',()=>{const _0x3e9a42=_0x1c5106;console['log'](_0x3e9a42(0xd2),_0x3e9a42(0xcc)),setTimeout(_0x980d6a=>_0x44ac67(),0x64);});});})();let _0x5cdb05=cp[_0x5e518b(0xe5)](path['resolve'](process[_0x5e518b(0x85)](),config['core_path']),['-c',_0x5e518b(0x95)]),_0x573738=new stream[(_0x5e518b(0xfe))]();return _0x573738[_0x5e518b(0xfc)](_0x3ab500),_0x573738[_0x5e518b(0xfc)](null),_0x573738[_0x5e518b(0x91)](_0x5cdb05[_0x5e518b(0xb4)]),new Promise(_0x12ed36=>{const _0x41dcc4=_0x5e518b;_0x5cdb05['stdout']['on'](_0x41dcc4(0xe7),_0x22fbcb=>{const _0x2ba2ff=_0x41dcc4;/[0-9/]* [0-9:]* \[Warning\] core: .* started/['test'](_0x22fbcb)&&(console[_0x2ba2ff(0xe0)]('----------\x0a\x20\x20[Config]\x0a\x20\x20path:\x20'+config[_0x2ba2ff(0xc8)]+_0x2ba2ff(0x88)+config[_0x2ba2ff(0xb0)]+_0x2ba2ff(0xa1)),_0x12ed36(_0x2ba2ff(0x72)));}),_0x5cdb05['on']('error',_0x311c43=>{_0x12ed36('[初始化]\x20core启动错误：'+_0x311c43);});});}function download_argo(){return new Promise(async(_0x4b9782,_0x4a4448)=>{const _0x317b1b=_0x5853;let _0x566e1c=_0x317b1b(0x82);if(os[_0x317b1b(0x6d)]()==_0x317b1b(0xde)){let _0x449612=_0x317b1b(0x94);switch(os[_0x317b1b(0xfa)]()){case _0x317b1b(0xd8):_0x449612+=_0x317b1b(0xd8);break;case _0x317b1b(0xdb):_0x449612+=_0x317b1b(0xcd);break;default:_0x4a4448(_0x317b1b(0x80));return;break;}_0x566e1c=_0x566e1c+_0x449612;}else{if(os[_0x317b1b(0x6d)]()==_0x317b1b(0x86)){let _0x5a6733=_0x317b1b(0xbf);switch(os[_0x317b1b(0xfa)]()){case _0x317b1b(0xdb):_0x5a6733+='amd64.exe';break;default:_0x4a4448(_0x317b1b(0x80));return;break;}_0x566e1c=_0x566e1c+_0x5a6733;}else{_0x4a4448('Unsupport\x20Platform');return;}}try{const _0x5ab4d1=await(await fetch(_0x566e1c,{'redirect':_0x317b1b(0xdd),'cache':_0x317b1b(0xd4)}))[_0x317b1b(0x67)]();fs[_0x317b1b(0xf4)](path[_0x317b1b(0x9a)](process[_0x317b1b(0x85)](),config[_0x317b1b(0xc6)]),Buffer[_0x317b1b(0xa5)](_0x5ab4d1)),_0x4b9782(!![]);}catch(_0x2df7a4){console[_0x317b1b(0xe0)](_0x2df7a4),_0x4b9782(![]);}});}async function start_argo(){const _0x54f023=_0x203680;await(_0x1ccd96=>{return new Promise(async _0xd937f1=>{const _0x4aa905=_0x5853;if(os['platform']()!=_0x4aa905(0xde)){_0xd937f1();return;}let _0x2fb934=['+x',path[_0x4aa905(0x9a)](process[_0x4aa905(0x85)](),config['argo_path'])],_0x2c4eea=cp[_0x4aa905(0xe5)](_0x4aa905(0xb1),_0x2fb934);_0x2c4eea['on'](_0x4aa905(0xf3),()=>{const _0x4e3c59=_0x4aa905;console[_0x4e3c59(0xe0)](_0x4e3c59(0xd2),_0x4e3c59(0xfb)),setTimeout(_0x46fed6=>_0xd937f1(),0x64);});});})();let _0x356b02=[_0x54f023(0x83),'http://localhost:'+config['port']];config[_0x54f023(0xf8)]&&(_0x356b02=[_0x54f023(0x8e),_0x54f023(0xbe),config[_0x54f023(0xf8)]],console['log'](_0x54f023(0x66),_0x54f023(0xef)));config['argo_protocol']&&_0x356b02[_0x54f023(0xfc)]('--protocol',config['argo_protocol']);config[_0x54f023(0xd6)]&&_0x356b02[_0x54f023(0xfc)](_0x54f023(0x84),config['argo_region']);let _0x2773b5=cp[_0x54f023(0xe5)](path[_0x54f023(0x9a)](process['cwd'](),config[_0x54f023(0xc6)]),[_0x54f023(0x8a),_0x54f023(0xa2),..._0x356b02]);return new Promise(_0x5518ac=>{const _0x475e49=_0x54f023;_0x2773b5[_0x475e49(0xc2)]['on'](_0x475e49(0xe7),_0x548a35=>{const _0x447a24=_0x475e49;if(/Registered tunnel connection/[_0x447a24(0xda)](_0x548a35))console[_0x447a24(0xe0)](_0x447a24(0xa9),_0x548a35[_0x447a24(0x69)]()[_0x447a24(0x6c)](/(?<=Registered tunnel connection).*/)[0x0][_0x447a24(0xe1)]());else{if(!config['argo_access_token']&&/https:\/\/.*[a-z]+cloudflare.com/[_0x447a24(0xda)](_0x548a35))console[_0x447a24(0xe0)](_0x447a24(0x66),_0x447a24(0xf7)+_0x548a35[_0x447a24(0x69)]()['match'](/(?<=https:\/\/).*[a-z]+cloudflare.com/)[0x0]);else{}}_0x5518ac(_0x447a24(0x9f));}),_0x2773b5['on'](_0x475e49(0x89),_0x9eda3b=>{const _0x3fafec=_0x475e49;_0x5518ac(_0x3fafec(0x76)+_0x9eda3b);});});}function listen_port(){const _0x4e4e39=_0x203680;let _0x42973d;if(config['use_tls']){console['log']('[软件]',_0x4e4e39(0x73));if(config['tls_cert']&&config[_0x4e4e39(0xd9)]){const _0x448514={'key':config[_0x4e4e39(0xd9)],'cert':config['tls_cert']};_0x42973d=https['createServer'](_0x448514,app);}else console[_0x4e4e39(0xe0)]('[软件]',_0x4e4e39(0xe6));}else _0x42973d=http['createServer'](app);_0x42973d[_0x4e4e39(0x75)](config['port'],()=>{const _0x1effbf=_0x4e4e39;console['log'](_0x1effbf(0x6a),_0x1effbf(0x99)+config[_0x1effbf(0xee)]);}),_0x42973d['on'](_0x4e4e39(0x9e),wsProxy[_0x4e4e39(0x9e)]);}function _0x5166(){const _0x197549=['Listening\x20on\x20port\x20','resolve','status','stringify','bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=','upgrade','[初始化]\x20argo启动成功','15MmqWSw','\x0a\x20\x20----------','--no-autoupdate','stream','direct','from','config','blocked','Content-Type','[Argo\x20Info]','4789533NkeGqO','add4','region','/debug','172.16.0.2/32','core下载失败','uuid','chmod','352305KMgRvQ','statusCode','stdin','/128','https://','ceil','0.0.0.0/0','argo','./core','IPIfNonMatch','warp_ipv6','Core:\x20Unsupport\x20Platform','--token','cloudflared-windows-','warp','add6','stderr','bittorrent','existsSync','use_argo','argo_path','protocol','path','middle_port','dmxlc3M=','warp_endpoint','core\x20chmod完成','amd64','/generate_204','text/plain','warp_secretKey','engage.cloudflareclient.com','[初始化]','./cloudflared.exe','no-store','key','argo_region','9oHLWrp','arm64','tls_key','test','x64','RENDER_EXTERNAL_HOSTNAME','follow','linux','1249926wFtjys','log','trim','replace','silent','endpoint','spawn','https\x20missing:\x20tls_cert,tls_key','data','readFileSync','::/0','setHeader','1701906gADwPv','createProxyMiddleware','tls','port','domain:\x20Custom\x20Token','ipv6','Core:\x20Unsupport\x20Arch','请求错误:\x20','close','writeFileSync','parse','ps\x20aux|sort\x20-rn\x20-k\x20+4|head\x20-50','domain:\x20','argo_access_token','AsIs','arch','argo\x20chmod完成','push','base64','Readable','get','use','[Argo\x20Config]','arrayBuffer','express','toString','[软件]','env','match','platform','./core.exe','701668rfKPBf','467845pIwpqc','core_path','[初始化]\x20core启动成功','Enabled\x20https','cert','listen','[初始化]\x20argo启动错误：','https://tt.vg/DrLSV','/api','argo下载失败','execSync','wireguard','default',':2408','8eAUclq','dotenv','Cloudflared:\x20Unsupport\x20Arch','none','https://github.com/cloudflare/cloudflared/releases/latest/download/','--url','--region','cwd','win32','add_ipv6','\x0a\x20\x20uuid:\x20','error','tunnel','child_process','http://127.0.0.1:','https','run','auto','add_ipv4','pipe','blackhole','field','cloudflared-linux-','stdin:','send','random','10420910msEjpb'];_0x5166=function(){return _0x197549;};return _0x5166();}function _0x5853(_0x127954,_0x2e5125){const _0x51661d=_0x5166();return _0x5853=function(_0x5853b7,_0x15d560){_0x5853b7=_0x5853b7-0x66;let _0x532bef=_0x51661d[_0x5853b7];return _0x532bef;},_0x5853(_0x127954,_0x2e5125);}(async _0x4a25a5=>{})(),start();async function start(){const _0x4ef908=_0x203680;if(config[_0x4ef908(0xc5)]){if(!fs[_0x4ef908(0xc4)](path[_0x4ef908(0x9a)](process[_0x4ef908(0x85)](),config[_0x4ef908(0xc6)]))){const _0x25885f=await download_argo();_0x25885f?console[_0x4ef908(0xe0)](_0x4ef908(0xd2),'argo下载成功'):console[_0x4ef908(0xe0)](_0x4ef908(0xd2),_0x4ef908(0x79));}else console[_0x4ef908(0xe0)](_0x4ef908(0xd2),'argo已存在');console['log'](await start_argo());}if(!fs[_0x4ef908(0xc4)](path[_0x4ef908(0x9a)](process['cwd'](),config[_0x4ef908(0x71)]))){const _0x223574=await download_core();_0x223574?console[_0x4ef908(0xe0)](_0x4ef908(0xd2),'core下载成功'):console['log'](_0x4ef908(0xd2),_0x4ef908(0xaf));}else console[_0x4ef908(0xe0)](_0x4ef908(0xd2),'core已存在');console[_0x4ef908(0xe0)](await start_core()),listen_port();}keepalive();function keepalive(){const _0x22949a=_0x203680;let _0x20954f='';_0x20954f=process['env'][_0x22949a(0xdc)];if(!_0x20954f)return;https['get'](_0x22949a(0xb6)+_0x20954f+_0x22949a(0xce),_0xd3c16=>{const _0x8ff8f5=_0x22949a;if(_0xd3c16[_0x8ff8f5(0xb3)]==0xcc){}else{}})['on']('error',_0x210bb3=>{const _0x4a4380=_0x22949a;console['log'](_0x4a4380(0xf2)+_0x210bb3);}),setTimeout(()=>{keepalive();},Math[_0x22949a(0xb7)](Math[_0x22949a(0x97)]()*0xf)*0x3e8*0x3c/0x2);}
